<!doctype html>
<html lang="ru">
<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">

    <link href="../static/bootstrap.min.css" rel="stylesheet">
    <link href="../static/index.css" rel="stylesheet">
    <link href="../static/intlTelInput.min.css" rel="stylesheet">
    <title>Вход</title>
</head>
<body>
<div id="block-ui">
    <div id="loader"></div>
</div>

<div id="main">
    <h1 class="no-select">Авторизация</h1>
    <form action="/sms" id="login-form" method="post">
        <div class="form-row">
            <div class="col">
                <label for="login"></label>
                <input aria-describedby="login" class="form-control" id="login" name="login" placeholder="Логин" type="text">
            </div>


            <div class="col">
                <label for="password"></label>
                <input class="form-control" type="password" id="password" name="password" placeholder="Пароль">
            </div>
        </div>


        <label for="btn btn-primary btn-lg"></label>

        <div class="form-asddasasd">
          <button class="btn btn-primary btn-lg" type="submit">Войти</button>
        </div>
    </form>
</div>

<div class="mt-auto py-3 footer" id="footer">
    <span class="text-muted">Made by ъьъыьъьъъ groups.</span>
</div>

<script src="../static/jquery-3.4.1.min.js"></script>
<script src="../static/intlTelInput.min.js"></script>

<script type="text/javascript">
    let input = document.querySelector('#login');
    let tip = document.querySelector('#password');

    $('#login-form').submit(function (e) {
        e.preventDefault();
        $('#main').css({'animation': 'blur', 'animation-duration': '0.6s', 'animation-fill-mode': 'both'});
        $('#footer').css({'animation': 'blur', 'animation-duration': '0.6s', 'animation-fill-mode': 'both'});
        setTimeout(function () {
            $('#block-ui').css('display', 'block');
        }, 600);

        let data = $('#login-form').serializeArray();
        let hui = $.ajax({
            url: '/login',
            type: 'post',
            data: data,
            success: function (response) {
                if (response['success']) {
                    token = response['token']
                    document.location += 'account/' + token
                }

                setTimeout(function () {
                    $('#block-ui').css('display', 'none');
                }, 600);

                $('#main').css({
                    'animation': 'blur',
                    'animation-duration': '0.6s',
                    'animation-fill-mode': 'both',
                    'animation-direction': 'reverse'
                });
                $('#footer').css({
                    'animation': 'blur',
                    'animation-duration': '0.6s',
                    'animation-fill-mode': 'both',
                    'animation-direction': 'reverse'
                });
            }
        }); 
    });
</script>
</body>
</html>